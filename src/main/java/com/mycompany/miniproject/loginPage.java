/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package com.mycompany.miniproject;

import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.DBCursor;
import com.mongodb.DBObject;
import com.mongodb.MongoClient;
import java.awt.HeadlessException;
import javax.swing.JOptionPane;

/**
 *
 * @author arnavprabhale
 */
public class loginPage extends javax.swing.JFrame
{

    /**
     * Creates new form loginPage
     */
    loginPage lp;
    String infoString[];
    StudentInfo stud;
    int errorcount = 0;
    
    public loginPage()
    {
        initComponents();
        lp = this;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents()
    {

        mainPanel = new javax.swing.JPanel();
        subPanel = new javax.swing.JPanel();
        loginPanel = new javax.swing.JPanel();
        passPanel = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        txtpassword = new javax.swing.JPasswordField();
        rollnoPanel = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        txtrollno = new javax.swing.JTextField();
        btnLogin = new javax.swing.JButton();
        lblinvalid = new javax.swing.JLabel();
        btnexit = new javax.swing.JButton();
        instructionPanel = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Online Exams");
        setResizable(false);

        mainPanel.setBackground(new java.awt.Color(114, 114, 114));

        subPanel.setBackground(new java.awt.Color(107, 107, 107));
        subPanel.setToolTipText("");

        loginPanel.setBackground(new java.awt.Color(100, 100, 100));

        passPanel.setBackground(new java.awt.Color(93, 93, 93));

        jLabel3.setFont(new java.awt.Font("Malayalam MN", 1, 18)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("PASSWORD");

        txtpassword.setFont(new java.awt.Font("Malayalam MN", 0, 18)); // NOI18N
        txtpassword.addActionListener(new java.awt.event.ActionListener()
        {
            public void actionPerformed(java.awt.event.ActionEvent evt)
            {
                txtpasswordActionPerformed(evt);
            }
        });
        txtpassword.addKeyListener(new java.awt.event.KeyAdapter()
        {
            public void keyTyped(java.awt.event.KeyEvent evt)
            {
                txtpasswordKeyTyped(evt);
            }
        });

        javax.swing.GroupLayout passPanelLayout = new javax.swing.GroupLayout(passPanel);
        passPanel.setLayout(passPanelLayout);
        passPanelLayout.setHorizontalGroup(
            passPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(passPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(passPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtpassword, javax.swing.GroupLayout.Alignment.TRAILING))
                .addContainerGap())
        );
        passPanelLayout.setVerticalGroup(
            passPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(passPanelLayout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtpassword, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        rollnoPanel.setBackground(new java.awt.Color(93, 93, 93));

        jLabel4.setFont(new java.awt.Font("Malayalam MN", 1, 18)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("ROLL NUMBER");

        txtrollno.setFont(new java.awt.Font("Malayalam MN", 0, 18)); // NOI18N
        txtrollno.addKeyListener(new java.awt.event.KeyAdapter()
        {
            public void keyTyped(java.awt.event.KeyEvent evt)
            {
                txtrollnoKeyTyped(evt);
            }
        });

        javax.swing.GroupLayout rollnoPanelLayout = new javax.swing.GroupLayout(rollnoPanel);
        rollnoPanel.setLayout(rollnoPanelLayout);
        rollnoPanelLayout.setHorizontalGroup(
            rollnoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(rollnoPanelLayout.createSequentialGroup()
                .addGroup(rollnoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(rollnoPanelLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(txtrollno))
                .addContainerGap())
        );
        rollnoPanelLayout.setVerticalGroup(
            rollnoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(rollnoPanelLayout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtrollno, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        btnLogin.setBackground(new java.awt.Color(86, 86, 86));
        btnLogin.setFont(new java.awt.Font("Malayalam MN", 1, 18)); // NOI18N
        btnLogin.setForeground(new java.awt.Color(255, 255, 255));
        btnLogin.setText("LOGIN");
        btnLogin.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        btnLogin.addActionListener(new java.awt.event.ActionListener()
        {
            public void actionPerformed(java.awt.event.ActionEvent evt)
            {
                btnLoginActionPerformed(evt);
            }
        });

        lblinvalid.setFont(new java.awt.Font("Malayalam MN", 1, 14)); // NOI18N
        lblinvalid.setForeground(new java.awt.Color(255, 255, 255));
        lblinvalid.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);

        btnexit.setBackground(new java.awt.Color(86, 86, 86));
        btnexit.setFont(new java.awt.Font("Malayalam MN", 1, 18)); // NOI18N
        btnexit.setForeground(new java.awt.Color(255, 255, 255));
        btnexit.setText("EXIT");
        btnexit.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        btnexit.addActionListener(new java.awt.event.ActionListener()
        {
            public void actionPerformed(java.awt.event.ActionEvent evt)
            {
                btnexitActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout loginPanelLayout = new javax.swing.GroupLayout(loginPanel);
        loginPanel.setLayout(loginPanelLayout);
        loginPanelLayout.setHorizontalGroup(
            loginPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(loginPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(passPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, loginPanelLayout.createSequentialGroup()
                .addContainerGap(50, Short.MAX_VALUE)
                .addGroup(loginPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(lblinvalid, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnLogin, javax.swing.GroupLayout.DEFAULT_SIZE, 282, Short.MAX_VALUE)
                    .addComponent(btnexit, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 282, Short.MAX_VALUE))
                .addGap(48, 48, 48))
            .addGroup(loginPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(loginPanelLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(rollnoPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addContainerGap()))
        );
        loginPanelLayout.setVerticalGroup(
            loginPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, loginPanelLayout.createSequentialGroup()
                .addContainerGap(162, Short.MAX_VALUE)
                .addComponent(passPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnLogin, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblinvalid, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnexit, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(80, 80, 80))
            .addGroup(loginPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(loginPanelLayout.createSequentialGroup()
                    .addGap(16, 16, 16)
                    .addComponent(rollnoPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(409, Short.MAX_VALUE)))
        );

        instructionPanel.setBackground(new java.awt.Color(100, 100, 100));

        jTextArea1.setEditable(false);
        jTextArea1.setColumns(20);
        jTextArea1.setFont(new java.awt.Font("Malayalam MN", 0, 16)); // NOI18N
        jTextArea1.setRows(5);
        jTextArea1.setText("                   Before starting the exam\n\n1.  Make sure your device (mobile/tab/laptop/\n    desktop) is ready and at your disposal for \n    appearing for the online exam.\n\n2.  Make sure you have a good and stable \n    internet connection.\n\n3. Make sure you join the Zoom room through \n    student online portal, in the same way you \n    join your regular online live classes, \n    designated for the respective subject’s \n    online exam, at least 15 minutes prior to \n    the stipulated time of the actual exam.\n\n4.  After joining the Zoom room, mark your \n    attendance with the invigilators present in \n    the room. If a student’s name doesn’t appear \n    in the list of examinees shared by the \n    invigilators to the exam cell, that student’s \n    exam shall be considered ‘disqualified’ by the \n    exam cell.\n\n5.  Ensure your visibility to the invigilators by \n    enabling the camera of your device (mobile/tab\n    /laptop/desktop).\n\n6.  Login to the online exam page (Student online \n    portal > Student login > Dashboard > Online \n    Test) 5 minutes prior to the stipulated time \n    of the exam and wait for the invigilator’s \n    instruction. Do not click on the START button \n    until you are prompted by the invigilators to \n    do so.\n\n7.  Make sure you DO NOT open any other link/tab \n    on your browser apart from the exam link during \n    the online exam.\n    \n8.  Listen to all the instructions by invigilators \n    carefully and comply with them meticulously.\n\n\n\n               \t During the exam\n\n1.  Do not resize or minimise the browser during \n    the online exam.\n\n2.  Do not close the browser during the test before \n    your exam is complete.\n\n3.  Do not click the ‘BACK’ button of browser \n    during exam.\n\n4.  Keep an eye on the TIMER CLOCK on top left of \n    the online exam page of the browser to keep a \n    track of the time left.\n\n5.  Do not leave the online exam browser page IDLE \n    for more than 5 minutes to prevent the system \n    from logging you out automatically. Keep \n    moving the cursor (for laptop/desktop) or \n    touch the screen (from mobile) frequently \n    during the exam.\n\n6.  After finishing the exam, click on the \n    PRE-CONFIRM button at the bottom of the \n    browser page.\n\n7.  On the window that pops up on clicking the \n    pre-confirm button, cross check your \n    ‘admission number’ and the total number of \n    questions attempted.\n\n8.  If the number of questions attempted shown \n    is not correct, press on CANCEL to go back \n    to the main question paper and check for \n    any anomaly.\n\n9.  If the number of questions attempted shown \n    is correct, click the checkbox \n    ‘Match as per attempted’ and click \n    the ‘SUBMIT’ button.\n\n10. Once submitted, a message shall be \n    displayed “Your Exam has been submitted \n    successfully’ and you can logout from the \n    student online portal.\n\n\n");
        jScrollPane1.setViewportView(jTextArea1);

        javax.swing.GroupLayout instructionPanelLayout = new javax.swing.GroupLayout(instructionPanel);
        instructionPanel.setLayout(instructionPanelLayout);
        instructionPanelLayout.setHorizontalGroup(
            instructionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 414, Short.MAX_VALUE)
        );
        instructionPanelLayout.setVerticalGroup(
            instructionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1)
        );

        jLabel1.setFont(new java.awt.Font("Malayalam MN", 1, 18)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("STUDENT LOGIN");

        jLabel2.setFont(new java.awt.Font("Malayalam MN", 1, 18)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("INSTRUCTIONS");

        javax.swing.GroupLayout subPanelLayout = new javax.swing.GroupLayout(subPanel);
        subPanel.setLayout(subPanelLayout);
        subPanelLayout.setHorizontalGroup(
            subPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(subPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(subPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(loginPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(subPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(instructionPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        subPanelLayout.setVerticalGroup(
            subPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, subPanelLayout.createSequentialGroup()
                .addGroup(subPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 33, Short.MAX_VALUE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(subPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(instructionPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(loginPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        javax.swing.GroupLayout mainPanelLayout = new javax.swing.GroupLayout(mainPanel);
        mainPanel.setLayout(mainPanelLayout);
        mainPanelLayout.setHorizontalGroup(
            mainPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(mainPanelLayout.createSequentialGroup()
                .addGap(45, 45, 45)
                .addComponent(subPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(45, 45, 45))
        );
        mainPanelLayout.setVerticalGroup(
            mainPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(mainPanelLayout.createSequentialGroup()
                .addGap(45, 45, 45)
                .addComponent(subPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(45, 45, 45))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(mainPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(mainPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void txtpasswordActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_txtpasswordActionPerformed
    {//GEN-HEADEREND:event_txtpasswordActionPerformed
        // TODO add your handling code here:
        lblinvalid.setText("");

    }//GEN-LAST:event_txtpasswordActionPerformed

    private void txtrollnoKeyTyped(java.awt.event.KeyEvent evt)//GEN-FIRST:event_txtrollnoKeyTyped
    {//GEN-HEADEREND:event_txtrollnoKeyTyped
        lblinvalid.setText("");
        CommonFunctions.alphanumeric(evt);

        // TODO add your handling code here:
    }//GEN-LAST:event_txtrollnoKeyTyped

    private void btnLoginActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_btnLoginActionPerformed
    {//GEN-HEADEREND:event_btnLoginActionPerformed
        
        
        
        
        
        try
        {
            MongoClient mongo = new MongoClient("localhost", 27017);
            
            DB db = mongo.getDB("BloodDonation");
            
            DBCollection table = db.getCollection("Donor");
           
            DBCursor cursor = table.find();
            DBObject disp = cursor.next();
            
            
            String rollno = txtrollno.getText();
	    String txtpass = new String(txtpassword.getPassword());
            System.out.println(rollno + "  " + txtpass);	  
	    	  
            while (cursor.hasNext()) 
            {
                    String id  = (String)disp.get("RollNo");
                    System.out.println("Step 1");
                    System.out.println(rollno + "  " + id);

                    if(rollno.equals(id))
                    {  
                        System.out.println("Step 2");
                        String nameString = (String) disp.get("Name");
                        
                        String passString = (String) disp.get("password");
                        System.out.println("pass ==" + passString);
//                        int passString = Integer.parseInt(pass);

                        int test_no = (Integer) disp.get("test number");

                        stud = new StudentInfo(nameString, passString, rollno, test_no);
                        stud.print();
                        System.out.println("Result Found");
                        
                        if(passString.equals(txtpass))
                        {
                            System.out.println("Step 3");
                            if(btnLogin.getText().equals("Attempt Again"))
                            {
                                int res = JOptionPane.showConfirmDialog(mainPanel, "Start Exam", "Please Confirm", JOptionPane.YES_NO_OPTION);
                                if(JOptionPane.YES_OPTION == res)
                                {
                                    
                                    DBCollection set = db.getCollection("BloodGroup");

                                    String rollString = txtrollno.getText();

                                    BasicDBObject deleteQuery = new BasicDBObject();
                                    deleteQuery.put("RollNo", rollString);

                                    DBCursor cursor1 = set.find(deleteQuery);
                                    while (cursor1.hasNext()) 
                                    {
                                     DBObject item = cursor1.next();
                                     set.remove(item);
                                    }
                                    System.out.println("Data Deleted");

                                    questionPage qp = new questionPage(stud);
                                    qp.setVisible(true);
                                    lp.setVisible(false);
                                    
//                                    cameraValidation cv = new cameraValidation(stud);
//                                    qp.setVisible(true);
//                                    lp.setVisible(false);
                                    
                                }
                                else
                                {
                                    System.out.println("Enters else 1");
                                }
                                
                                
                            }
                            else if(((String) disp.get("attendence")).equals("absent"))
                            {
                                System.out.println("Step 5");
                                int res = JOptionPane.showConfirmDialog(mainPanel, "Start Exam", "Please Confirm", JOptionPane.YES_NO_OPTION);
                
                                if(JOptionPane.YES_OPTION == res)
                                {
                                    System.out.println("Step 6");
                                    System.out.println("Password match");
                                    
                                    
                                    BasicDBObject newDocument = new BasicDBObject();
                                    newDocument.append("RollNo", rollno);
                                    newDocument.append("Name", nameString);
                                    newDocument.append("password", passString);
                                    newDocument.append("test number", test_no);
                                    newDocument.append("attendence", "present");
                                    
                                    BasicDBObject searchQuery = new BasicDBObject();
                                    searchQuery.append("RollNo", rollno);
                                    
	        		
	        	 
                                    table.update(searchQuery, newDocument);
                                  

                                    questionPage qp = new questionPage(stud);
                                    qp.setVisible(true);
                                    lp.setVisible(false);
                                    
//                                    cameraValidation cv = new cameraValidation(stud);
//                                    qp.setVisible(true);
//                                    lp.setVisible(false);
                                    
                                }
                                else
                                {
                                    System.out.println("Enters else 1");
                                    errorcount++;
                                }
                            }
                            else
                            {
                                errorcount++;
                                System.out.println("Enters else 2");
                                lblinvalid.setText("Test Already Attempted");
                                btnLogin.setText("Attempt Again");
                                
                            }
                        }
                        else
                        {
                            System.out.println("Enters else 3");
                            txtpassword.setText("");
                            txtrollno.setText("");
                            lblinvalid.setText("invalid username or password");
                        }

                        break;
                    }
                    disp =  cursor.next();
            }  
            if(errorcount == 0)
            {
                txtpassword.setText("");
                txtrollno.setText("");
                lblinvalid.setText("invalid username or password");
            }
            

        } 
        catch (HeadlessException | NumberFormatException  e)
        {
            JOptionPane.showMessageDialog(mainPanel, "Error = " + e);
        }
        
        
//        txtpassword.setText("");
//        txtrollno.setText("");
//        lblinvalid.setText("invalid username or password");
        
        // TODO add your handling code here:
    }//GEN-LAST:event_btnLoginActionPerformed

    private void txtpasswordKeyTyped(java.awt.event.KeyEvent evt)//GEN-FIRST:event_txtpasswordKeyTyped
    {//GEN-HEADEREND:event_txtpasswordKeyTyped
        CommonFunctions.numericValidation(evt);
        lblinvalid.setText("");
        // TODO add your handling code here:
    }//GEN-LAST:event_txtpasswordKeyTyped

    private void btnexitActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_btnexitActionPerformed
    {//GEN-HEADEREND:event_btnexitActionPerformed
        System.exit(0);
        // TODO add your handling code here:
    }//GEN-LAST:event_btnexitActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[])
    {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try
        {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels())
            {
                if ("Nimbus".equals(info.getName()))
                {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex)
        {
            java.util.logging.Logger.getLogger(loginPage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex)
        {
            java.util.logging.Logger.getLogger(loginPage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex)
        {
            java.util.logging.Logger.getLogger(loginPage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex)
        {
            java.util.logging.Logger.getLogger(loginPage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                new loginPage().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnLogin;
    private javax.swing.JButton btnexit;
    private javax.swing.JPanel instructionPanel;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JLabel lblinvalid;
    private javax.swing.JPanel loginPanel;
    private javax.swing.JPanel mainPanel;
    private javax.swing.JPanel passPanel;
    private javax.swing.JPanel rollnoPanel;
    private javax.swing.JPanel subPanel;
    private javax.swing.JPasswordField txtpassword;
    private javax.swing.JTextField txtrollno;
    // End of variables declaration//GEN-END:variables
}
